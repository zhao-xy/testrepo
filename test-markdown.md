
2016-11-04 kalykeサーバソフトウェアアップデート作業 手順書
============================================================


### 担当者

アップデート作業
: 中西、趙

アプリケーションの動作確認
: 畠村

### サーバーIPアドレス

kalyke本番サーバ
: 219.94.243.96

### 動作確認用ブラウザ

PC 版 Firefox の最新版を使用する。

必ずブラウザ履歴・クッキーを消去してから行う。

#### ブラウザ履歴・クッキーを消去する方法

https://support.mozilla.org/ja/kb/delete-browsing-search-download-history-firefox


作業手順
------------------------------------------------------------

1. サービス停止

  ```
  service httpd stop
  ```

2. バックアップ

  ```
  mysqldump --default-character-set=utf8mb4 --hex-blob -ukalyke_admin -p kalyke > kalyke-dump-20161104.sql
  mysqldump --default-character-set=utf8mb4 --hex-blob -ukalyke_admin -p kalyke_1_0 > kalyke_1_0-dump-20161104.sql
  ```

3. 旧データベースの掃除

  ```
  mysql -ukalyke_admin -p kalyke -e "DROP DATABASE kalyke_1_0"
  ```

4. mysqld 停止

  ```
  service mysqld stop
  ```

3. アップデート

  ```
  sudo su -
  yum update
  find /etc -name "*rpm*"
  ... do something ...
  reboot
  ```

4. サービス再開

  ```
  service mysqld start
  service httpd start
  ```

5. 動作確認

- テストケース1: データベースが動作していることを確認する
    1. [ ] ブラウザを初期化する
    2. [ ] https://agent.acaric.jp/ にアクセスし、ブラウザにアカリクAGENTのトップページが表示されていることを確認する


- テストケース2: PRO AGENTのシステムとの連携を確認する
    1. [ ] ブラウザを初期化する
    2. [ ] https://agent.acaric.jp/career/ にアクセスし、求人情報の一覧が表示されていることを確認する
    3. [ ] 任意の求人情報のタイトルをクリックし、求人情報の詳細画面に遷移する
    4. [ ] 求人の内容が表示されていることを確認する


- テストケース3: 初めての利用者として登録ができることを確認する
    1. [ ] テスト登録することを事前に関係スタッフに通知する
    2. [ ] ブラウザを初期化する
    3. [ ] https://agent.acaric.jp/registration/ にアクセスする
    4. [ ] `初めての利用` と `【利用規約】に同意する` にチェックを入れ、 `登録` ボタンをクリックする
    5. [ ] 記入項目に以下の通りに入力する

    ```
    基本情報
        氏名：アカリクテスト
        フリガナ：アカリクテスト
        生年月日：1916年1月1日
        性別：男性
        住所
            〒：000-0000
            都道府県：東京都
            住所：テスト
        連絡先
            連絡先：電話
            電話番号：00-0000-0000
        メール：test@acaric.com

    学歴
        期間：2020年1月 - 2020年2月
        卒退区分：卒業
        学歴区分
            （学校区分）：中学
            （卒隊区分）：文系
        学校名/学部名/学科名：テストです

    職務経歴：
        現在の状況：現職中
        勤務歴
            期間：2020年1月 - 2020年2月
            会社名：テスト
            部署名：テスト
            役職名：テスト
            事業内容：テスト
            従業員数：1
            雇用形態：正社員

    経験業種職種
        業種・職種
            業種：ソフトウェア・情報処理
            職種：技術系（IT・インターネット・通信） システムアナリスト・コンサルタント
            経験年数：1年未満

    転職希望条件
        希望業界職種
            業種：ソフトウェア・情報処理
            職種：技術系（IT・インターネット・通信） システムアナリスト・コンサルタント
        勤務地：東京都
        転職時期：2021年1月1日
    ```

    6. [ ] `次へ` ボタンをクリックする
    7. [ ] 確認画面で `登録` ボタンをクリックする
    8. [ ] 出力された登録完了ページに `登録が完了しました。アカリク担当者より、登録いただいたメールアドレス/電話番号宛にご連絡いたしますので、しばらくお待ちくださいませ。` と表示されていることを確認する。


- テストケース4: 2回目以降の利用者として登録ができることを確認する
    1. [ ] テスト登録することを事前に関係スタッフに通知する
    2. [ ] ブラウザを初期化する
    3. [ ] https://agent.acaric.jp/registration/ にアクセスする
    4. [ ] `2回目以降の利用` と `【利用規約】に同意する` にチェックを入れ、 `登録` ボタンをクリックする
    5. [ ] 記入項目に以下の通りに入力する

    ```
    基本情報
        氏名：アカリクテスト
        フリガナ：アカリクテスト
        生年月日：1916年1月1日
        性別：男性
        住所
            〒：000-0000
            都道府県：東京都
            住所：テスト
        連絡先
            連絡先：電話
            電話番号：00-0000-0000
        メール：test@acaric.com
    ```

    6. [ ] `次へ` ボタンをクリックする
    7. [ ] 確認画面で `登録` ボタンをクリックする
    8. [ ] 出力された登録完了ページに `登録が完了しました。アカリク担当者より、登録いただいたメールアドレス/電話番号宛にご連絡いたしますので、しばらくお待ちくださいませ。` と表示されていることを確認する。


以上.
